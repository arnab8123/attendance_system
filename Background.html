<!-- Excel grid spotlight background -->
<div class="grid-background" id="gridBg"></div>

<style>
/* === Excel-style spotlight grid background === */
.grid-background {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;

    background-image:
        linear-gradient(var(--grid-color) 1px, transparent 1px),
        linear-gradient(90deg, var(--grid-color) 1px, transparent 1px);
    background-size: 80px 25px;
    background-color: var(--grid-bg);
    pointer-events: none;
    z-index: 0;

    -webkit-mask-image: radial-gradient(
        circle 400px at var(--x, 50%) var(--y, 50%),
        rgba(0,0,0,1) 0%,
        rgba(0,0,0,0.6) 70%,
        rgba(0,0,0,0) 100%
    );
    -webkit-mask-repeat: no-repeat;
    -webkit-mask-size: cover;
    mask-image: radial-gradient(
        circle 400px at var(--x, 50%) var(--y, 50%),
        rgba(0,0,0,1) 0%,
        rgba(0,0,0,0.6) 70%,
        rgba(0,0,0,0) 100%
    );
    mask-repeat: no-repeat;
    mask-size: cover;

    opacity: 0; /* hidden by default */
    transition: opacity 0.4s ease, mask-position 0.2s ease, -webkit-mask-position 0.2s ease;
}
.grid-background.active {
    opacity: 1; /* visible when active */
}

/* Light mode grid: black lines on white */
:root {
    --grid-color: #00000020;
    --grid-bg: #ffffff;
}

/* Dark mode grid: white lines on black */
.dark-mode {
    --grid-color: #fff5f520;
    --grid-bg: #000000;
}
</style>

<script>
// Excel spotlight grid follows cursor
const gridBg = document.getElementById("gridBg");

document.addEventListener("mousemove", e => {
    gridBg.classList.add("active"); // Show spotlight when mouse moves
    gridBg.style.setProperty("--x", e.clientX + "px");
    gridBg.style.setProperty("--y", e.clientY + "px");
});

// Hide spotlight when cursor leaves the window
document.addEventListener("mouseleave", () => {
    gridBg.classList.remove("active");
});
</script>